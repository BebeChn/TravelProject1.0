@section Styles{
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link href="~/css/admindashboard.css" rel="stylesheet" />
}


<!--app-->
<div id="app">
    <!--app-->
    <div class="container">
        <br>
    </div>
    <!--頁首-->
    <header class="container-fluid row">
        <!--區塊-->
        <!--區塊-->
    </header>
    <!--頁首底-->
    <!--第一段-->
    <div class="container-fluid row  justify-content-between">
        <div class="col-1"></div>
        <div class="col-3"></div>
    </div>
    <br>
    <!--第二段-->
    <div class="container-fluid  row  ">
        <div class="col-9"></div>
        <div class="col-3  " style="width:25%; color: gray; ">
            關鍵字搜尋：<input type="text" v-model="Filter" class="form-control" placeholder="請輸入篩選關鍵字" @@keyup="filterorder" />
        </div>
    </div>
    <br>
    <!--第三段-->
    <div class="container-fluid ">
        <!--管理選單-->
        @*        <div class="col-1">
        </div>*@
        <!--管理內容-->
        <div class=" table-responsive">
            <table class="table table-bordered ">
                <thead>
                    <tr>
                        <th>訂單ID</th>
                        <th>總價</th>
                        <th>訂單狀態</th>
                        <th>訂單日期</th>
                        <th>訂購人ID</th>
                        <th>獲得點數</th>
                        <th>操作 </th>
                    </tr>
                </thead>
                <tbody>

                    <tr v-for="item in order ">
                        <template v-if="item.Edit==true" class="text-center">
                            <td>{{item.orderId}}</td>
                            <td>{{item.totalPrice}}</td>
                            <td>{{item.status}}</td>
                            <td><input /></td>
                            <td>{{item.userId}}</td>
                            <td><input></td>
                            <td>
                                <div class="d-flex justify-content-around">
                                    <button type="button" class="btn btn-success" >
                                        <div class="horizontal-text">
                                            <span>儲存</span>
                                        </div>
                                    </button>
                                    <button type="button" class="btn btn-info">
                                        <div class="horizontal-text">
                                            <span>取消</span>
                                        </div>
                                    </button>
                                </div>
                            </td>
                        </template>
                        <template v-else class="text-center">
                            <td>{{item.orderId }}</td>
                            <td>{{item.totalPrice }}</td>
                            <td>{{item.status }}</td>
                            <td>{{item.orderDate }}</td>
                            <td>{{item.userId }}</td>
                            <td>{{item.newPoint }}</td>
           
                            <td>
                                <div class="d-flex justify-content-around">
                                    <button :disabled="notchange" type="button" class="btn  btn-warning" @@click="item.Edit == true">
                                        <div class="horizontal-text "><span>修改</span></div>
                                    </button>

                                    <button :disabled="notchange" type="button" class="btn btn-danger" @@click="deleteOrder(item.orderId)">
                                        <div class="horizontal-text"><span>刪除</span></div>
                                    </button>
                                </div>
                            </td>
                        </template>
                    </tr>

                </tbody>
            </table>
        </div>
    </div>
    <!--app-->
</div>
<!--app-->
<br />
<br />







@section Scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js" integrity="sha512-uMtXmF28A2Ab/JJO2t/vYhlaa/3ahUOgj1Zf27M5rOo8/+fcTUVH0/E0ll68njmjrLqOBjXM3V9NiPFL5ywWPQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/vue@next"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous">
    </script>
    <script src="https://kit.fontawesome.com/ea5c2c7c03.js" crossorigin="anonymous"></script>





    <script>
        var vueApp = {
            data() {
                return {
                    order: []
                };
            },
            mounted: function () {
                this.getApiOrder();
            },
            computed: {

            },
            methods: {
                getApiOrder: function () {
                    let self = this;
                    fetch("/api/order/OrderSeachL").then(x => x.json()).then(x => self.order = {...x, Edit:false});
                },
                openChangeOrder:function(item){
                    item.Edit = true;
                },
                deleteOrder:function(id){
                    let self = this;
                    fetch("/api/order/OrderDELETE/"+id,{method:"delete"}).then(x => x.json())
                    .then(x => {
                        if(x){
                            alert("刪除成功");
                            var idx = this.order.findIndex(x=>x.orderId == id);
                            this.order.splice(idx,1);
                        }else{
                                alert("刪除成功");
                        }
                    });
                }
            }

        };
        var app = Vue.createApp(vueApp).mount("#app");

    </script>











}
