@* 各票券年度銷售額柱狀圖分析 *@
<div>
	<div id="getOneYearSales" style="min-width:100%; min-height:400px"></div>
</div>
@* 各票券年度銷售額柱狀圖分析 *@

@* 餅塊圖頁簽 *@
<nav>
	<div class="nav nav-tabs" id="nav-tab" role="tablist">
		<button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-airplane" type="button" role="tab" aria-controls="nav-airplane" aria-selected="true">飛機年度銷售</button>
		<button class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-hotel" type="button" role="tab" aria-hotel="nav-profile" aria-selected="false">住宿年度銷售</button>
		<button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-transportation" type="button" role="tab" aria-controls="nav-transportation" aria-selected="false">交通年度銷售</button>
		<button class="nav-link" id="nav-contact-tab" data-bs-toggle="tab" data-bs-target="#nav-attractions" type="button" role="tab" aria-controls="nav-attractions" aria-selected="false">景點年度銷售</button>
	</div>
</nav>
@* 餅塊圖頁簽 *@

@* 餅塊圖頁簽各內容切換*@
<div class="tab-content" id="nav-tabContent">
	@* 飛機 *@
	<div class="tab-pane fade show active" id="nav-airplane" role="tabpanel" aria-labelledby="nav-airplane-tab" tabindex="0">
		<div id="airplane" style="height: 400px"></div>
	</div>
	@* 飛機 *@

	@* 住宿 *@
	<div class="tab-pane fade" id="nav-hotel" role="tabpanel" aria-labelledby="nav-hotel-tab" tabindex="0">
		<div id="hotel" style="height: 400px"></div>
	</div>
	@* 住宿 *@

	@* 交通 *@
	<div class="tab-pane fade" id="nav-transportation" role="tabpanel" aria-labelledby="nav-transportation-tab" tabindex="0">
		<div id="transportation" style="height: 400px"></div>
	</div>
	@* 交通 *@

	@* 景點 *@
	<div class="tab-pane fade" id="nav-attractions" role="tabpanel" aria-labelledby="nav-attractions-tab" tabindex="0">
		<div id="attractions" style="height: 400px"></div>
	</div>
	@* 景點 *@
</div>
@* 餅塊圖頁簽各內容切換*@


@section Scripts
	{
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js" integrity="sha512-aoTNnqZcT8B4AmeCFmiSnDlc4Nj/KPaZyB5G7JnOnUEkdNpCZs1LCankiYi01sLTyWy+m2P+W4XM+BuQ3Q4/Dg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://code.highcharts.com/highcharts-3d.js"></script>
	<script>
		axios.get('/api/SaleChart/GetCurrentYearAllTicktesSales')
			.then(response => {

				//各票券今天年度銷售柱狀圖分析

				//API得來的數據做分類，放到個圖表的series
				const xTitle = Object.keys(response.data.airplaneOneYearSale);
				const airplaneOneYearSale = Object.values(response.data.airplaneOneYearSale);
				const hotelOneYearSale = Object.values(response.data.hotelOneYearSale);
				const transportationOneYearSale = Object.values(response.data.transportationOneYearSale);
				const attractionsOneYearSale = Object.values(response.data.attractionsOneYearSale);
				const airplane = Object.values(response.data.airplane);
				const hotel = Object.values(response.data.hotel);
				const transportation = Object.values(response.data.transportation);
				const attractions = Object.values(response.data.attractions);
				//API得來的數據做分類，放到個圖表的series

				//今年度各票券銷售柱狀圖
				const chart = Highcharts.chart('getOneYearSales', {
					chart: {
						type: "column",
					},
					title: {
						text: "各票券月份銷售金額",
					},
					subtitle: {
						text: ''
					},
					credits: {
						enabled: false
					},
					legend: {
						// 圖例設定
					},
					tooltip: {
						text: '萬',
					},
					xAxis: {
						categories: xTitle,
					},
					yAxis: {
						title: {
							text: "銷售額"
						}
					},
					series: [{
						name: "飛機票券",
						data: airplaneOneYearSale,
					},
					{
						name: "住宿票券",
						data: hotelOneYearSale,
					},
					{
						name: "交通票券",
						data: transportationOneYearSale,
					},
					{
						name: "景點票券",
						data: attractionsOneYearSale,
					}]
				});
				//今年度各票券銷售柱狀圖

				//飛機票券銷售3D餅圖
				const airplane3D = Highcharts.chart('airplane', {
					chart: {
						type: 'pie',
						options3d: {
							enabled: true,
							alpha: 45,
							beta: 0
						}
					},
					title: {
						text: '年度銷售'
					},
					tooltip: {
						pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					},
					plotOptions: {
						pie: {
							allowPointSelect: true,
							cursor: 'pointer',
							depth: 35,
							dataLabels: {
								enabled: true,
								format: '{point.name}'
							}
						}
					},
					series: [{
						type: 'pie',
						name: '佔年度銷售',
						data: airplane
					}]
				});
				//飛機票券銷售3D餅圖

				//住宿票券銷售3D餅圖
				const hotel3D = Highcharts.chart('hotel', {
					chart: {
						type: 'pie',
						options3d: {
							enabled: true,
							alpha: 45,
							beta: 0
						}
					},
					title: {
						text: '年度銷售 '
					},
					tooltip: {
						pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					},
					plotOptions: {
						pie: {
							allowPointSelect: true,
							cursor: 'pointer',
							depth: 35,
							dataLabels: {
								enabled: true,
								format: '{point.name}'
							}
						}
					},
					series: [{
						type: 'pie',
						name: '佔年度銷售',
						data: hotel
					}]
				});
				//住宿票券銷售3D餅圖

				//交通票券銷售3D餅圖
				const transportation3D = Highcharts.chart('transportation', {
					chart: {
						type: 'pie',
						options3d: {
							enabled: true,
							alpha: 45,
							beta: 0
						}
					},
					title: {
						text: '年度銷售 '
					},
					tooltip: {
						pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					},
					plotOptions: {
						pie: {
							allowPointSelect: true,
							cursor: 'pointer',
							depth: 35,
							dataLabels: {
								enabled: true,
								format: '{point.name}'
							}
						}
					},
					series: [{
						type: 'pie',
						name: '佔年度銷售',
						data: transportation
					}]
				});
				//交通票券銷售3D餅圖

				//景點票券銷售3D餅圖
				const attractions3D = Highcharts.chart('attractions', {
					chart: {
						type: 'pie',
						options3d: {
							enabled: true,
							alpha: 45,
							beta: 0
						}
					},
					title: {
						text: '年度銷售 '
					},
					tooltip: {
						pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
					},
					plotOptions: {
						pie: {
							allowPointSelect: true,
							cursor: 'pointer',
							depth: 35,
							dataLabels: {
								enabled: true,
								format: '{point.name}'
							}
						}
					},
					series: [{
						type: 'pie',
						name: '佔年度銷售',
						data: attractions
					}]
				});
				//景點票券銷售3D餅圖
			}).catch(err => {
				alert('今年度數據請求異常聯絡管理員')
			});
            //各票券今天年度銷售柱狀圖分析
	</script>
}