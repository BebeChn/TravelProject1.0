@* 各票券當月銷售額柱狀圖分析頁簽按鈕 *@
<nav class="mt-3">
	<div class="nav nav-tabs" id="nav-tab" role="tablist">
		<button class="nav-link active" id="nav-currentWeek-tab" data-bs-toggle="tab" data-bs-target="#nav-currentWeek" type="button" role="tab" aria-controls="nav-currentWeek" aria-selected="true">當週銷售數據</button>
		<button class="nav-link" id="nav-currentMonthSales-tab" data-bs-toggle="tab" data-bs-target="#nav-currentMonthSales" type="button" role="tab" aria-controls="nav-currentMonthSales" aria-selected="false">當月銷售數據</button>
	</div>
</nav>
@* 各票券當月銷售額柱狀圖分析頁簽按鈕 *@

@* 各票券當月銷售額柱狀圖分析頁簽內容 *@
<div class="tab-content" id="nav-tabContent">

	@* 當週各票券各月銷售柱狀圖頁簽內容 *@
	<div class="tab-pane fade show active" id="nav-currentWeek" role="tabpanel" aria-labelledby="nav-currentWeek-tab" tabindex="0">
		<div id="currentWeek" style="min-width:100%; min-height:400px"></div>
	</div>
	@* 當週各票券各月銷售柱狀圖頁簽內容  *@

	@* 當月各票券各月銷售柱狀圖頁簽內容  *@
	<div class="tab-pane fade" id="nav-currentMonthSales" role="tabpanel" aria-labelledby="nav-currentMonthSales-tab" tabindex="0">
		<div id="currentMonthSales" style="min-width:100%; min-height:400px"></div>
	</div>
	@* 當月各票券各月銷售柱狀圖頁簽內容  *@

</div>
@* 當月度銷售額柱狀圖分析頁簽內容 *@


<!--當週機票以及住宿Top10Sales-->
<div class="row my-3">
	<div class="col-6">
		<div id="currentWeekTop10Airplane"></div>
	</div>
	<div class="col-6">
		<div id="currentWeekTop10Hotel"></div>
	</div>
</div>
<!--當週機票以及住宿Top10Sales-->

<!--當週交通以及景點Top10Sales-->
<div class="row my-3">
	<div class="col-6">
		<div id="currentWeekTop10Transportation"></div>
	</div>
	<div class="col-6">
		<div id="currentWeekTop10Attractions"></div>
	</div>
</div>
<!--當週交通以及景點Top10Sales-->
@section Scripts
	{
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js" integrity="sha512-aoTNnqZcT8B4AmeCFmiSnDlc4Nj/KPaZyB5G7JnOnUEkdNpCZs1LCankiYi01sLTyWy+m2P+W4XM+BuQ3Q4/Dg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://code.highcharts.com/highcharts-3d.js"></script>
	<script>
		axios.get("/api/SaleChart/CurrentWeekSale")
			.then(response => {
				//API得來的數據做分類，放到個圖表的series
				const xTitle = Object.keys(response.data.airplaneSale);
				const currentWeekAirplaneSale = Object.values(response.data.airplaneSale);
				const currentWeekHotelSale = Object.values(response.data.hotelSale);
				const currentWeekTransportationSale = Object.values(response.data.transportationSale);
				const currentWeekAttractionsSale = Object.values(response.data.attractionsSale);
				//API得來的數據做分類，放到個圖表的series

				//當週各票券銷售柱狀圖
				const weekChart = Highcharts.chart('currentWeek', {
					chart: {
						type: "column",
					},
					title: {
						text: "各票券當週銷售金額",
					},
					subtitle: {
						text: '當週銷售累計：' + response.data.saleTotal + '萬',
					},
					credits: {
						enabled: false
					},
					legend: {
						// 圖例設定
					},
					tooltip: {
						text: '萬',
					},
					xAxis: {
						categories: xTitle,
					},
					yAxis: {
						title: {
							text: "銷售額"
						}
					},
					series: [{
						name: "飛機票券",
						data: currentWeekAirplaneSale,
					},
					{
						name: "住宿票券",
						data: currentWeekHotelSale,
					},
					{
						name: "交通票券",
						data: currentWeekTransportationSale,
					},
					{
						name: "景點票券",
						data: currentWeekAttractionsSale,
					}]
				});
				//當週各票券銷售柱狀圖
			})
			.catch(err => {
				alert(err);
			});
		//當週度各票券銷售柱狀圖

		//當月各票券銷售柱狀圖
		axios.get("/api/SaleChart/CurrentMonthSale")
			.then(response => {
				//API得來的數據做分類，放到個圖表的series
				const xTitle = Object.keys(response.data.airplaneSale);
				const currentMonthAirplaneSale = Object.values(response.data.airplaneSale);
				const currentMonthHotelSale = Object.values(response.data.hotelSale);
				const currentMonthTransportationSale = Object.values(response.data.transportationSale);
				const currentMonthAttractionsSale = Object.values(response.data.attractionsSale);
				//API得來的數據做分類，放到個圖表的series

				//當月各票券銷售柱狀圖
				const monthChart = Highcharts.chart('currentMonthSales', {
					chart: {
						type: "column",
					},
					title: {
						text: "各票券各月份銷售金額",
					},
					subtitle: {
						text: '當月銷售累計：' + response.data.saleTotal + '萬',
					},
					credits: {
						enabled: false
					},
					legend: {
						// 圖例設定
					},
					tooltip: {
						text: '萬',
					},
					xAxis: {
						categories: xTitle,
					},
					yAxis: {
						title: {
							text: "銷售額"
						}
					},
					series: [{
						name: "飛機票券",
						data: currentMonthAirplaneSale,
					},
					{
						name: "住宿票券",
						data: currentMonthHotelSale,
					},
					{
						name: "交通票券",
						data: currentMonthTransportationSale,
					},
					{
						name: "景點票券",
						data: currentMonthAttractionsSale,
					}]
				});
			})
			.catch(err => {
				alert(err);
			});
		//當月各票券銷售柱狀圖

		//當週各票券銷售Top10
		axios.get("/api/SaleChart/CurrentWeekTop10AllTicktes")
			.then(response => {
				//API得來的數據做分類，放到個圖表的series
				const currentWeekTop10AirplaneSaleName = Object.keys(response.data.airplaneSale)
				const currentWeekTop10HotelSaleName = Object.keys(response.data.hotelSale)
				const currentWeekTop10TransportationSaleName = Object.keys(response.data.transportationSale)
				const currentWeekTop10AttractionsSaleName = Object.keys(response.data.attractionsSale)
				const currentWeekTop10AirplaneSaleData = Object.values(response.data.airplaneSale)
				const currentWeekTop10HotelSaleData = Object.values(response.data.hotelSale)
				const currentWeekTop10TransportationSaleData = Object.values(response.data.transportationSale)
				const currentWeekTop10AttractionsSaleData = Object.values(response.data.attractionsSale)
				//API得來的數據做分類，放到個圖表的series

				//當周飛機票券橫條圖
				Highcharts.chart('currentWeekTop10Airplane', {
					chart: {
						type: 'bar'
					},
					title: {
						text: '機票當周Top10',
						align: 'left'
					},
					subtitle: {
						text: '',
						align: 'left'
					},
					xAxis: {
						categories: '',
						title: {
							text: null
						},
						gridLineWidth: 1,
						lineWidth: 0
					},
					yAxis: {
						min: 0,
						title: {
							text: '銷售數量',
							align: 'high'
						},
						labels: {
							overflow: 'justify'
						},
						gridLineWidth: 0
					},
					tooltip: {
						valueSuffix: '張'
					},
					plotOptions: {
						bar: {
							borderRadius: '50%',
							dataLabels: {
								enabled: true
							},
							groupPadding: 0.1
						}
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'top',
						x: -40,
						y: 80,
						floating: true,
						borderWidth: 1,
						backgroundColor:
							Highcharts.defaultOptions.legend.backgroundColor || '#d6ccc2',
						shadow: true
					},
					credits: {
						enabled: false
					},
					series: [{
						name: currentWeekTop10AirplaneSaleName,
						data: currentWeekTop10AirplaneSaleData
					}]
				});
				//當周飛機票券橫條圖

				//當周住宿票券橫條圖
				Highcharts.chart('currentWeekTop10Hotel', {
					chart: {
						type: 'bar'
					},
					title: {
						text: '住宿當週Top10',
						align: 'left'
					},
					subtitle: {
						text: '',
						align: 'left'
					},
					xAxis: {
						categories: '',
						title: {
							text: null
						},
						gridLineWidth: 1,
						lineWidth: 0
					},
					yAxis: {
						min: 0,
						title: {
							text: '銷售數量',
							align: 'high'
						},
						labels: {
							overflow: 'justify'
						},
						gridLineWidth: 0
					},
					tooltip: {
						valueSuffix: '張'
					},
					plotOptions: {
						bar: {
							borderRadius: '50%',
							dataLabels: {
								enabled: true
							},
							groupPadding: 0.1
						}
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'top',
						x: -40,
						y: 80,
						floating: true,
						borderWidth: 1,
						backgroundColor:
							Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
						shadow: true
					},
					credits: {
						enabled: false
					},
					series: [{
						name: currentWeekTop10HotelSaleName,
						data: currentWeekTop10HotelSaleData
					}]
				});
				//當周住宿票券橫條圖

				//當周交通票券橫條圖
				Highcharts.chart('currentWeekTop10Transportation', {
					chart: {
						type: 'bar'
					},
					title: {
						text: '交通當週Top10',
						align: 'left'
					},
					subtitle: {
						text: '',
						align: 'left'
					},
					xAxis: {
						categories: '',
						title: {
							text: null
						},
						gridLineWidth: 1,
						lineWidth: 0
					},
					yAxis: {
						min: 0,
						title: {
							text: '銷售數量',
							align: 'high'
						},
						labels: {
							overflow: 'justify'
						},
						gridLineWidth: 0
					},
					tooltip: {
						valueSuffix: '張'
					},
					plotOptions: {
						bar: {
							borderRadius: '50%',
							dataLabels: {
								enabled: true
							},
							groupPadding: 0.1
						}
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'top',
						x: -40,
						y: 80,
						floating: true,
						borderWidth: 1,
						backgroundColor:
							Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
						shadow: true
					},
					credits: {
						enabled: false
					},
					series: [{
						name: currentWeekTop10TransportationSaleName,
						data: currentWeekTop10TransportationSaleData
					}]
				});
				//當周交通票券橫條圖

				//當周景點票券橫條圖
				Highcharts.chart('currentWeekTop10Attractions', {
					chart: {
						type: 'bar'
					},
					title: {
						text: '景點當週Top10',
						align: 'left'
					},
					subtitle: {
						text: '',
						align: 'left'
					},
					xAxis: {
						categories: '',
						title: {
							text: null
						},
						gridLineWidth: 1,
						lineWidth: 0
					},
					yAxis: {
						min: 0,
						title: {
							text: '銷售數量',
							align: 'high'
						},
						labels: {
							overflow: 'justify'
						},
						gridLineWidth: 0
					},
					tooltip: {
						valueSuffix: '張'
					},
					plotOptions: {
						bar: {
							borderRadius: '50%',
							dataLabels: {
								enabled: true
							},
							groupPadding: 0.1
						}
					},
					legend: {
						layout: 'vertical',
						align: 'right',
						verticalAlign: 'top',
						x: -40,
						y: 80,
						floating: true,
						borderWidth: 1,
						backgroundColor:
							Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
						shadow: true
					},
					credits: {
						enabled: false
					},
					series: [{
						name: currentWeekTop10AttractionsSaleName,
						data: currentWeekTop10AttractionsSaleData
					}]
				});
				//當周景點票券橫條圖
			})
			.catch(err => {
				alert(err);
			});
							//當週各票券銷售Top10
	</script>
}